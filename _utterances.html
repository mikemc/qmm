<!-- Adapted from https://github.com/MilesMcBain/milesmcbain.com/blob/master/utterances.html and https://github.com/rstudio/distill/issues/155#issuecomment-694296957 -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (!/posts/.test(location.pathname)) {
      return;
    }

    var script = document.createElement("script");
    script.src = "https://utteranc.es/client.js";
    script.setAttribute("repo", "mikemc/qmm");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("crossorigin", "anonymous");
    script.setAttribute("label", "comment_thread");

    /* wait for article to load, append script to article element */
    var observer = new MutationObserver(function (mutations, observer) {
      // change "d-appendix" to "d-article" to place between the article and appendix
      var article = document.querySelector("d-appendix");
      if (article) {
        observer.disconnect();
        /* HACK: article scroll */
        article.setAttribute("style", "overflow-y: hidden");
        article.appendChild(script);
      }
    });

    observer.observe(document.body, { childList: true });
  });
</script>
